<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æµ‹è¯•æ–‡ç« </title>
    <link href="/posts/4131.html"/>
    <url>/posts/4131.html</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>å›¾è®ºåŸºç¡€åŠç»˜åˆ¶(python)</title>
    <link href="/posts/18665.html"/>
    <url>/posts/18665.html</url>
    
    <content type="html"><![CDATA[<h2 id="å›¾çš„åŸºç¡€ç†è®º">å›¾çš„åŸºç¡€ç†è®º</h2><h3 id="å›¾çš„åŸºæœ¬æ¦‚å¿µ">å›¾çš„åŸºæœ¬æ¦‚å¿µ</h3><p>å®šä¹‰1ï¼šå›¾æ˜¯ä¸€äº›ç‚¹å’Œè¿™äº›ç‚¹ä¹‹é—´çš„è¿çº¿ç»„æˆçš„ã€‚å®šä¹‰ä¸º<span class="math inline">\(G=(V,E)\)</span>,<span class="math inline">\(V\)</span>æ˜¯é¡¶ç‚¹(vertex)çš„éç©ºæœ‰é™é›†åˆï¼Œç§°ä¸ºé¡¶ç‚¹é›†,<span class="math inline">\(E\)</span>æ˜¯è¾¹(edge)çš„é›†åˆï¼Œç§°ä¸ºè¾¹é›†ã€‚è¾¹ä¸€èˆ¬ç”¨<span class="math inline">\((v_i,v_j)\)</span>è¡¨ç¤ºï¼Œå…¶ä¸­<span class="math inline">\(v_i,v_j\in V\)</span>,ç”¨<span class="math inline">\(\vert V \vert\)</span>è¡¨ç¤ºå›¾ä¸­é¡¶ç‚¹çš„ä¸ªæ•°ï¼Œ<span class="math inline">\(\vert E\vert\)</span>è¡¨ç¤ºè¾¹çš„æ¡æ•°ã€‚</p><h3 id="æœ‰å‘å›¾å’Œæ— å‘å›¾">æœ‰å‘å›¾å’Œæ— å‘å›¾</h3><p>å®šä¹‰2ï¼šå›¾çš„è¾¹æœ‰æ–¹å‘ç§°ä¸ºæœ‰å‘å›¾ï¼Œæ²¡æœ‰æ–¹å‘ç§°ä¸ºå¼§ã€‚æœ‰å‘å›¾çš„å¼§çš„èµ·ç‚¹ç§°ä¸ºå¼§å¤´ï¼Œå¼§çš„ç»ˆç‚¹ç§°ä¸ºå¼§å°¾ã€‚æœ‰å‘å›¾ä¸€èˆ¬è®°ä¸º<span class="math inline">\(D=(V,A)\)</span>,å…¶ä¸­<span class="math inline">\(V\)</span>ä¸ºé¡¶ç‚¹é›†,<span class="math inline">\(A\)</span>ä¸ºå¼§é›†ã€‚</p><h3 id="ç®€å•å›¾å’Œå®Œå…¨å›¾">ç®€å•å›¾å’Œå®Œå…¨å›¾</h3><p>å®šä¹‰3ï¼šè®¾<span class="math inline">\(e=(u,v)\)</span>æ˜¯å›¾<span class="math inline">\(G\)</span>çš„ä¸€æ¡è¾¹,åˆ™ç§°<span class="math inline">\(u,v\)</span>æ˜¯<span class="math inline">\(e\)</span>çš„ç«¯ç‚¹ï¼Œå¹¶ç§°<span class="math inline">\(u,v\)</span>ç›¸é‚»ï¼Œè¾¹<span class="math inline">\(e\)</span>ä¸é¡¶ç‚¹<span class="math inline">\(uæˆ–(v)\)</span>ç›¸å…³è”ã€‚è‹¥ä¸¤æ¡è¾¹<span class="math inline">\(e_i,e_j\)</span>æœ‰å…±åŒçš„ç«¯ç‚¹ï¼Œåˆ™ç§°<span class="math inline">\(e_i,e_j\)</span>ç›¸é‚»ï¼Œç§°æœ‰ç›¸åŒç«¯ç‚¹çš„ä¸¤æ¡è¾¹ä¸ºé‡è¾¹ã€‚ç§°ä¸¤ç«¯ç‚¹ç›¸åŒçš„è¾¹ä¸ºç¯ã€‚ç§°ä¸ä¸ä»»ä½•è¾¹ç›¸å…³è”çš„é¡¶ç‚¹ä¸ºå­¤ç«‹ç‚¹ã€‚</p><p>å®šä¹‰4ï¼šæ— ç¯ä¸”æ— é‡è¾¹çš„å›¾ç§°ä¸ºç®€å•å›¾</p><p>å®šä¹‰5ï¼šä»»æ„ä¸¤é¡¶ç‚¹å‡ç›¸é‚»çš„ç®€å•å›¾ç§°ä¸ºå®Œå…¨å›¾ï¼Œå«æœ‰<span class="math inline">\(n\)</span>ä¸ªé¡¶ç‚¹çš„å®Œå…¨å›¾è®°ä¸º<span class="math inline">\(K_n\)</span></p><h3 id="èµ‹æƒå›¾">èµ‹æƒå›¾</h3><p>å®šä¹‰6ï¼šå¦‚æœå›¾<span class="math inline">\(G\)</span>çš„æ¯ä¸€æ¡è¾¹<span class="math inline">\(e\)</span>éƒ½é™„æœ‰ä¸€ä¸ªå®æ•°<span class="math inline">\(w(e)\)</span>ï¼Œåˆ™ç§°å›¾<span class="math inline">\(G\)</span>ä¸ºèµ‹æƒå›¾,å®æ•°<span class="math inline">\(w(e)\)</span>ç§°ä¸ºè¾¹<span class="math inline">\(e\)</span>çš„æƒ</p><h3 id="é¡¶ç‚¹çš„åº¦">é¡¶ç‚¹çš„åº¦</h3><p>å®šä¹‰7ï¼šï¼ˆ1ï¼‰åœ¨æ— å‘å›¾ä¸­ä¸é¡¶ç‚¹<span class="math inline">\(v\)</span>ç›¸å…³è”çš„è¾¹(ç¯ç®—ä¸¤æ¬¡)çš„æ•°ç›®ç§°ä¸º<span class="math inline">\(v\)</span>çš„åº¦,è®°ä½œ<span class="math inline">\(d(v)\)</span></p><p>â€‹ ï¼ˆ2ï¼‰åœ¨æœ‰å‘å›¾ä¸­ï¼Œä»é¡¶ç‚¹<span class="math inline">\(v\)</span>å¼•å‡ºçš„å¼§çš„æ•°ç›®ç§°ä¸º<span class="math inline">\(v\)</span>çš„å‡ºåº¦ï¼Œè®°ä½œ<span class="math inline">\(d^{+}(v)\)</span>,ä»é¡¶ç‚¹<span class="math inline">\(v\)</span>å¼•å…¥å¼§çš„æ•°ç›®ç§°ä¸ºå¼§çš„å…¥åº¦ï¼Œè®°ä½œ<span class="math inline">\(d^{-}(v)\)</span>ï¼Œ <span class="math inline">\(d(v)=d^{+}(v)+d^{-}(v)\)</span>ç§°ä¸º<span class="math inline">\(v\)</span>çš„åº¦</p><pre><code class="hljs">                åº¦ä¸ºå¥‡æ•°çš„é¡¶ç‚¹ç§°ä¸ºå¥‡é¡¶ç‚¹ï¼Œåº¦ä¸ºå¶æ•°çš„é¡¶ç‚¹ç§°ä¸ºå¶é¡¶ç‚¹ã€‚</code></pre><p>å®šç†1ï¼šç»™å®šå›¾<span class="math inline">\(G=(V,E)\)</span>,æ‰€æœ‰é¡¶ç‚¹çš„åº¦æ•°ä¹‹å’Œæ˜¯è¾¹æ•°çš„2å€ï¼Œå³<span class="math display">\[\sum_{v\in V}d(v) = 2\vert E\vert\]</span> æ¨è®ºï¼šä»»ä½•å›¾ä¸­å¥‡é¡¶ç‚¹çš„æ•°ç›®æ€»ä¸ºå¶æ•°</p><h3 id="å­å›¾">å­å›¾</h3><p>å®šä¹‰8ï¼šè®¾<span class="math inline">\(G_1=(V_1,E_1)\)</span>vä¸<span class="math inline">\(G_2=(V_2,E_2)\)</span>æ˜¯ä¸¤ä¸ªå›¾,å¹¶ä¸”æ»¡è¶³<span class="math inline">\(V_1\subset V_2,E_1\subset E_2\)</span>ï¼Œåˆ™ç§°<span class="math inline">\(G_1\)</span>æ˜¯<span class="math inline">\(G_2\)</span>çš„å­å›¾ã€‚å¦‚æœ<span class="math inline">\(G_1\)</span>æ˜¯<span class="math inline">\(G_2\)</span>çš„å­å›¾ï¼Œä¸”<span class="math inline">\(V_1=V_2\)</span>ï¼Œåˆ™ç§°<span class="math inline">\(G_1\)</span>æ˜¯<span class="math inline">\(G_2\)</span>çš„ç”Ÿæˆå­å›¾ã€‚</p><h3 id="é“è·¯ä¸å›è·¯">é“è·¯ä¸å›è·¯</h3><p>è®¾<span class="math inline">\(W=v_0e_1v_1e_2\cdotse_kv_k,\,where\quad e_i\in E,v_j\in V\)</span>ï¼Œ<span class="math inline">\(e_i\)</span>ä¸<span class="math inline">\(v_{i-1}\)</span>å’Œ<span class="math inline">\(v_i\)</span>ç›¸å…³è”ï¼Œç§°<span class="math inline">\(W\)</span>æ˜¯å›¾<span class="math inline">\(G\)</span>çš„ä¸€æ¡é“è·¯ï¼Œç®€ç§°è·¯ï¼Œ<span class="math inline">\(k\)</span>ä¸ºè·¯é•¿ï¼Œ<span class="math inline">\(v_0\)</span>ä¸ºèµ·ç‚¹,<span class="math inline">\(v_k\)</span>ä¸ºç»ˆç‚¹ï¼›å„è¾¹ç›¸å¼‚çš„é“è·¯ç§°ä¸ºè¿¹(trail);å„é¡¶ç‚¹ç›¸å¼‚çš„é“è·¯ç§°ä¸ºè½¨é“(path),è®°ä¸º<span class="math inline">\(P(v_0,v_k)\)</span>ï¼›èµ·ç‚¹å’Œç»ˆç‚¹ç›¸åŒçš„é“è·¯ç§°ä¸ºå›è·¯ï¼›èµ·ç‚¹å’Œç»ˆç‚¹é‡åˆçš„è½¨é“ç§°ä¸ºåœˆã€‚ç§°ä»¥ä¸¤é¡¶ç‚¹<span class="math inline">\(u,v\)</span>åˆ†åˆ«ä¸ºèµ·ç‚¹å’Œç»ˆç‚¹çš„æœ€çŸ­è½¨é“ä¹‹é•¿ä¸ºé¡¶ç‚¹<span class="math inline">\(u,v\)</span>çš„è·ç¦»ã€‚</p><h3 id="è¿é€šå›¾å’Œéè¿é€šå›¾">è¿é€šå›¾å’Œéè¿é€šå›¾</h3><p>åœ¨æ— å‘å›¾<span class="math inline">\(G\)</span>ä¸­ï¼Œå¦‚æœä»é¡¶ç‚¹<span class="math inline">\(u\)</span>åˆ°é¡¶ç‚¹<span class="math inline">\(v\)</span>å­˜åœ¨é“è·¯ï¼Œåˆ™ç§°é¡¶ç‚¹<span class="math inline">\(u\)</span>å’Œé¡¶ç‚¹<span class="math inline">\(v\)</span>æ˜¯è¿é€šçš„ã€‚å¦‚æœå›¾<span class="math inline">\(G\)</span>ä¸­ä»»æ„ä¸¤ä¸ªé¡¶ç‚¹éƒ½æ˜¯è¿é€šçš„ï¼Œåˆ™ç§°å›¾<span class="math inline">\(G\)</span>æ˜¯è”é€šå›¾ï¼Œå¦åˆ™ç§°ä¸ºéè¿é€šå›¾ã€‚</p><h2 id="å›¾çš„è¡¨ç¤º">å›¾çš„è¡¨ç¤º</h2><p>ä»¥ä¸‹å‡å‡è®¾å›¾<span class="math inline">\(G=(V,E)\)</span>ä¸ºç®€å•å›¾ï¼Œå…¶ä¸­<span class="math inline">\(V=\{v_1,v_2,\cdots,v_n\},E=\{e_1,e_2,\cdots,e_m\}\)</span></p><ul><li>å…³è”çŸ©é˜µ</li></ul><p>å¯¹äºæ— å‘å›¾<span class="math inline">\(G\)</span>ï¼Œå…¶å…³è”çŸ©é˜µ<span class="math inline">\(M=(M_{ij})_{n\times m}\)</span>,å…¶ä¸­ <span class="math display">\[m_{ij} = \begin{cases}1,\quad &amp;v_i\text{ä¸}e_j\text{ç›¸å…³è”}\\                    0ï¼Œ\quad &amp;v_i\text{ä¸}e_j\text{ä¸å…³è”}          \end{cases}\]</span> å¯¹æœ‰å‘å›¾<span class="math inline">\(G\)</span>,å…¶å…³è”çŸ©é˜µ<span class="math inline">\(M=(M_{ij})_{n\times m}\)</span>ï¼Œå…¶ä¸­ <span class="math display">\[m_{ij} = \begin{cases}1,\quad &amp;v_i\text{æ˜¯}e_j\text{èµ·ç‚¹}\\                    -1ï¼Œ\quad &amp;v_i\text{æ˜¯}e_j\text{ç»ˆç‚¹}\\                    0,\quad &amp;v_i\text{ä¸}e_j\text{ä¸å…³è”}          \end{cases}\]</span></p><ul><li>é‚»æ¥çŸ©é˜µ</li></ul><p>å¯¹äºæ— å‘éèµ‹æƒå›¾<span class="math inline">\(G\)</span>ï¼Œå…¶é‚»æ¥çŸ©é˜µ<span class="math inline">\(W=(w_{ij})_{n\times n}\)</span>å…¶ä¸­ <span class="math display">\[w_{ij} = \begin{cases}1,\quad &amp;v_i\text{ä¸}v_j\text{ç›¸é‚»}\\                    0ï¼Œ\quad &amp;v_i\text{ä¸}v_j\text{ä¸ç›¸é‚»}          \end{cases}\]</span> å¯¹äºæœ‰å‘éèµ‹æƒå›¾<span class="math inline">\(G\)</span>,å…¶é‚»æ¥çŸ©é˜µ<span class="math inline">\(W=(w_{ij})_{n\times n}\)</span>å…¶ä¸­ <span class="math display">\[w_{ij} = \begin{cases}1,\quad &amp;(v_i,v_j)\in A\\                    0ï¼Œ\quad &amp;(v_i,v_j)\notin A          \end{cases}\]</span> å¯¹äºæ— å‘èµ‹æƒå›¾ï¼Œå…¶é‚»æ¥çŸ©é˜µ<span class="math inline">\(W=(w_{ij})_{n\times n}\)</span>å…¶ä¸­ <span class="math display">\[w_{ij} =\begin{cases}\text{é¡¶ç‚¹}v_i\text{é¡¶ç‚¹}v_j\text{ä¹‹é—´è¾¹çš„æƒ},\quad&amp;(v_i,v_j)\in E\\                    0(\text{æˆ–}\infty)ï¼Œ\quad&amp;v_i,v_j\text{ä¹‹é—´æ— è¾¹}          \end{cases}\]</span></p><h2 id="ç»˜åˆ¶å›¾">ç»˜åˆ¶å›¾</h2><h3 id="ç»˜åˆ¶æ— å‘åŠ æƒå›¾">ç»˜åˆ¶æ— å‘åŠ æƒå›¾</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#ç»˜åˆ¶æ— å‘åŠ æƒå›¾</span><br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> networkx <span class="hljs-keyword">as</span> nx<br><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br>sns.set_theme(style=<span class="hljs-string">&quot;dark&quot;</span>)<span class="hljs-comment">#ç”¨æ¥è®¾ç½®ä¸»é¢˜èƒŒæ™¯</span><br>plt.rcParams[<span class="hljs-string">&quot;font.sans-serif&quot;</span>] = [<span class="hljs-string">&quot;SimHei&quot;</span>] <span class="hljs-comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span><br>plt.rcParams[<span class="hljs-string">&quot;axes.unicode_minus&quot;</span>] = <span class="hljs-literal">False</span> <span class="hljs-comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span><br>A = np.array([[<span class="hljs-number">0</span>,<span class="hljs-number">9</span>,<span class="hljs-number">2</span>,<span class="hljs-number">4</span>,<span class="hljs-number">7</span>]<br>             ,[<span class="hljs-number">9</span>,<span class="hljs-number">0</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">0</span>]<br>             ,[<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">0</span>,<span class="hljs-number">8</span>,<span class="hljs-number">4</span>]<br>             ,[<span class="hljs-number">4</span>,<span class="hljs-number">4</span>,<span class="hljs-number">8</span>,<span class="hljs-number">0</span>,<span class="hljs-number">6</span>]<br>             ,[<span class="hljs-number">7</span>,<span class="hljs-number">0</span>,<span class="hljs-number">4</span>,<span class="hljs-number">6</span>,<span class="hljs-number">0</span>]]) <span class="hljs-comment">#è¾“å…¥é‚»æ¥çŸ©é˜µ</span><br>i,j = np.nonzero(A) <span class="hljs-comment">#æå–é¡¶ç‚¹ç¼–å·</span><br>w = A[i,j] <span class="hljs-comment">#æå–Aéé›¶å…ƒç´ </span><br>edges = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">zip</span>(i,j,w)) <span class="hljs-comment">#æ„å»ºè¾¹list</span><br>G = nx.Graph()<span class="hljs-comment">#åˆ›å»ºæ— å‘å›¾ç±»</span><br>G.add_weighted_edges_from(edges) <span class="hljs-comment">#æ·»åŠ å¸¦æƒè¾¹</span><br>node_labels = <span class="hljs-built_in">dict</span>(<span class="hljs-built_in">zip</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>),[<span class="hljs-built_in">str</span>(i+<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">5</span>)]))<span class="hljs-comment">#é¡¶ç‚¹æ ‡ç­¾</span><br>pos = nx.shell_layout(G) <span class="hljs-comment">#å›¾å½¢å¸ƒå±€</span><br>nx.draw_networkx(G,pos,node_size=<span class="hljs-number">260</span>,labels=node_labels) <span class="hljs-comment">#ç»˜åˆ¶å›¾</span><br>w = nx.get_edge_attributes(G,<span class="hljs-string">&quot;weight&quot;</span>)<span class="hljs-comment">#è·å–è¾¹çš„æƒé‡å­—å…¸</span><br>nx.draw_networkx_edge_labels(G,pos,font_size=<span class="hljs-number">12</span>,edge_labels=w)<span class="hljs-comment">#æ ‡è®°æƒé‡</span><br>plt.show()<br></code></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/06/26/IOyV2s3AqZ6pXrW.png"></p>]]></content>
    
    
    <categories>
      
      <category>æ•°å­¦å»ºæ¨¡</category>
      
      <category>å›¾è®º</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>é€»è¾‘å›å½’</title>
    <link href="/posts/60504.html"/>
    <url>/posts/60504.html</url>
    
    <content type="html"><![CDATA[<h2 id="å¹¿ä¹‰çº¿æ€§æ¨¡å‹generalized-linear-model">å¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼ˆGeneralizedlinear modelï¼‰</h2><p>è®¾<span class="math inline">\(y=\hat{w}^{T}\cdot\hat{x},where\,\hat{w}=(w_1,w_2,\dots,w_n,b)^{T}\,\hat{x}=(x_1,x_2,\dots,x_n,1)^{T}\)</span>,ä»¤<span class="math inline">\(g(y)=\hat{w}^{T}\cdot\hat{x}\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(y=g(x)\)</span>ä¸ºè¿ç»­å¯å¾®å‡½æ•°ã€‚åˆ™è¯¥æ¨¡å‹ä¸ºå¹¿ä¹‰çº¿æ€§æ¨¡å‹ï¼Œè¯¥æ¨¡å‹çš„æå‡ºæ˜¯ä¸ºäº†è§£å†³çº¿æ€§æ¨¡å‹ç”±äºç®€å•è€Œå¸¦æœ‰çš„å±€é™æ€§ã€‚è‹¥ä»¤<span class="math inline">\(y=g(x)=ln(x)\)</span>ï¼Œåˆ™è¯¥æ¨¡å‹å¯è¡¨ç¤ºä¸º<span class="math inline">\(ln(y)=\hat{w}^{T}\cdot\hat{x} \iffy=\exp(\hat{w}^{T}\cdot\hat{x})\)</span>ï¼Œè¯¥æ¨¡å‹è¢«ç§°ä¸ºå¯¹æ•°çº¿æ€§æ¨¡å‹(logistlinear model).</p><h2 id="å¯¹æ•°å‡ ç‡æ¨¡å‹ä¸é€»è¾‘å›å½’">å¯¹æ•°å‡ ç‡æ¨¡å‹ä¸é€»è¾‘å›å½’</h2><ul><li>å‡ ç‡(odd)</li></ul><p>å‡ ç‡ä¸æ˜¯æ¦‚ç‡ï¼Œè€Œæ˜¯ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿä¸ä¸å‘ç”Ÿçš„æ¦‚ç‡çš„æ¯”å€¼ã€‚å‡è®¾æŸäº‹ä»¶Aå‘ç”Ÿçš„æ¦‚ç‡ä¸ºpï¼Œåˆ™è¯¥äº‹ä»¶ä¸å‘ç”Ÿçš„æ¦‚ç‡ä¸º1-pï¼Œè¯¥äº‹ä»¶çš„å‡ ç‡ä¸ºï¼š<span class="math inline">\(odd(A)=\frac{p}{1-p}\)</span>.åœ¨å‡ ç‡çš„åŸºç¡€ä¸Šå–ï¼ˆè‡ªç„¶åº•æ•°çš„ï¼‰å¯¹æ•°ï¼Œåˆ™æ„æˆè¯¥äº‹ä»¶çš„å¯¹æ•°å‡ ç‡ï¼ˆlogitï¼‰ï¼š<span class="math inline">\(logit(A)=\ln\frac{p}{1-p}\)</span></p><ul><li>å¯¹æ•°å‡ ç‡æ¨¡å‹</li></ul><p>å¦‚æœæˆ‘ä»¬å°†å¯¹æ•°å‡ ç‡çœ‹æˆæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶å°†å…¶ä½œä¸ºè”ç³»å‡½æ•°ï¼Œå³<span class="math inline">\(g(y)=\ln\frac{y}{1-y}\)</span>.åˆ™è¯¥å¹¿ä¹‰çº¿æ€§æ¨¡å‹ä¸ºï¼š<span class="math display">\[\ln\frac{y}{1-y}=\hat{w}^{T}\cdot\hat{x} \iffy=\frac{1}{1+\exp(-\hat{w}^{T}\cdot\hat{x})}\quad where\quady=\frac{1}{1+exp(-z)}è¢«ç§°ä¸ºSigmoidå‡½æ•°\]</span></p><ul><li>Sigmoidå‡½æ•°åŠå…¶å¯¼æ•°</li></ul><p><span class="math inline">\(Sigmoid(x)=\frac{1}{1+\exp(-x)},Sigmoid^{\prime}(x)=(1-Sigmoid(x))Sigmoid(x)\)</span>ï¼Œå…¶å›¾åƒå¦‚ä¸‹ï¼š</p><p><img src="https://s2.loli.net/2022/06/26/NOwe82Qgz5tlvPj.png"></p><h2 id="é€»è¾‘å›å½’æ¨¡å‹è¾“å‡ºç»“æœä¸æ¨¡å‹å¯è§£é‡Šæ€§">é€»è¾‘å›å½’æ¨¡å‹è¾“å‡ºç»“æœä¸æ¨¡å‹å¯è§£é‡Šæ€§</h2><ul><li>è¿ç»­å‹è¾“å‡ºç»“æœè½¬åŒ–ä¸ºåˆ†ç±»é¢„æµ‹ç»“æœ</li></ul><p>å¯¹äºé€»è¾‘å›å½’è¾“å‡ºçš„(0,1)ä¹‹é—´çš„è¿ç»­å‹æ•°å€¼ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šä¸€ä¸ªâ€œé˜ˆå€¼â€ï¼Œå°±å¯ä»¥å°†å…¶è½¬åŒ–ä¸ºäºŒåˆ†ç±»çš„ç±»åˆ«åˆ¤åˆ«ç»“æœã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸ªé˜ˆå€¼æ˜¯0.5ï¼Œå³ä»¥0.5ä¸ºç•Œï¼Œè°ƒæ•´æ¨¡å‹è¾“å‡ºç»“æœï¼š</p><p><span class="math display">\[\begin{equation}y_{cla}=\left\{\begin{aligned}0, y&lt;0.5 \\1, yâ‰¥0.5\end{aligned}\right.\end{equation}\]</span></p><p>è€Œæœ‰æ—¶å€™é€»è¾‘å›å½’å½“<span class="math inline">\(f1\_score\)</span>ç­‰ä½œä¸ºåˆ†ç±»è¯„ä»·æŒ‡æ ‡å¯ä»¥å°†é˜ˆå€¼è¿›è¡Œè°ƒæ•´ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å€ŸåŠ©sklearnä¸­çš„Logisticregressionæ¥æ„å»ºå¸¦æœ‰é˜ˆå€¼ç§»åŠ¨çš„è¯„ä¼°å™¨</span><br><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression<br><span class="hljs-keyword">from</span> sklearn.base <span class="hljs-keyword">import</span> BaseEstimator,TransformerMixin<br><span class="hljs-keyword">class</span> <span class="hljs-title class_">logistic_threshold</span>(BaseEstimator,TransformerMixin):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,penalty=<span class="hljs-string">&quot;l2&quot;</span>,C=<span class="hljs-number">1.0</span>,solver=<span class="hljs-string">&quot;lbfgs&quot;</span>,max_iter=<span class="hljs-built_in">int</span>(<span class="hljs-params"><span class="hljs-number">1e8</span></span>),l1_ratio=<span class="hljs-literal">None</span>,class_weight=<span class="hljs-literal">None</span>,thr=<span class="hljs-number">0.5</span></span>):<br>        self.penalty = penalty<br>        self.C = C<br>        self.solver = solver<br>        self.max_iter = max_iter<br>        self.l1_ratio = l1_ratio<br>        self.class_weight = class_weight<br>        self.thr = thr<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fit</span>(<span class="hljs-params">self,X,y</span>):<br>        clf =      LogisticRegression(slef.penalty,self.C,self.solver,self.max_iter,self.l1_ratio,self.class_weight).fit(X,y)<br>        self.coef_ = clf.coef_<br>        self.clf = clf<br>        <span class="hljs-keyword">return</span> self<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self,X</span>):<br>        res = (self.clf.predict_proba(X)[:,<span class="hljs-number">1</span>]&gt;self.thr)*<span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> res<br></code></pre></td></tr></table></figure><ul><li>é€»è¾‘å›å½’è¾“å‡ºç»“æœ(y)æ˜¯å¦æ˜¯æ¦‚ç‡</li></ul><p>å†³å®šyæ˜¯å¦æ˜¯æ¦‚ç‡çš„æ ¸å¿ƒå› ç´ ï¼Œä¸æ˜¯æ¨¡å‹æœ¬èº«ï¼Œè€Œæ˜¯å»ºæ¨¡æµç¨‹ã€‚â€ƒâ€ƒé€»è¾‘æ–¯è’‚æœ¬èº«ä¹Ÿæœ‰å¯¹åº”çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå› æ­¤è¾“å…¥çš„è‡ªå˜é‡å…¶å®æ˜¯å¯ä»¥è§†ä½œéšæœºå˜é‡çš„ï¼Œä½†å‰ææ˜¯éœ€è¦æ»¡è¶³ä¸€å®šçš„åˆ†å¸ƒè¦æ±‚ã€‚å¦‚æœé€»è¾‘å›å½’çš„å»ºæ¨¡æµç¨‹éµç…§æ•°ç†ç»Ÿè®¡æ–¹æ³•çš„ä¸€èˆ¬å»ºæ¨¡æµç¨‹ï¼Œå³è‡ªå˜é‡çš„åˆ†å¸ƒï¼ˆæˆ–è€…è½¬åŒ–ä¹‹åçš„åˆ†å¸ƒï¼‰æ»¡è¶³ä¸€å®šè¦æ±‚ï¼ˆé€šè¿‡æ£€éªŒï¼‰ï¼Œåˆ™æœ€ç»ˆæ¨¡å‹è¾“å‡ºç»“æœå°±æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„æ¦‚ç‡å–å€¼ã€‚è€Œå¦‚æœæ˜¯éµç…§æœºå™¨å­¦ä¹ å»ºæ¨¡æµç¨‹è¿›è¡Œå»ºæ¨¡ï¼Œåœ¨ä¸ºå¯¹è‡ªå˜é‡è¿›è¡Œå‡è®¾æ£€éªŒä¸‹è¿›è¡Œæ¨¡å‹æ„å»ºï¼Œåˆ™ç”±äºè‡ªå˜é‡åˆ†å¸ƒä¸ä¸€å®šæ»¡è¶³æ¡ä»¶ï¼Œå› æ­¤è¾“å‡ºç»“æœä¸ä¸€å®šä¸ºä¸¥æ ¼æ„ä¹‰ä¸Šçš„æ¦‚ç‡ã€‚</p><p>è€Œæˆ‘ä»¬åŸºæœ¬éƒ½é‡‡ç”¨æœºå™¨å­¦ä¹ å»ºæ¨¡æµç¨‹è¿›è¡Œé€»è¾‘å›å½’çš„æ„å»ºï¼Œå› æ­¤å¯¹äºæ¨¡å‹è¾“å‡ºç»“æœyï¼Œå…¶å®å¹¶ä¸ä¸€å®šæ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šçš„æ¦‚ç‡ã€‚ä¸è¿‡åœ¨ç›®å‰å¤§å¤šæ•°ä½¿ç”¨åœºæ™¯ä¸­ï¼Œç”±äºå¤§å®¶å¸Œæœ›èƒ½å¤Ÿç”¨åˆ°æ¨¡å‹æœ¬èº«çš„å¯è§£é‡Šæ€§ï¼Œå› æ­¤è¿˜æ˜¯ä¼šå°†æ¨¡å‹ç»“æœè§£è¯»ä¸º1å‘ç”Ÿçš„æ¦‚ç‡ã€‚å°½ç®¡è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªä¸¥è°¨çš„åšæ³•ï¼Œä½†åœ¨æœºå™¨å­¦ä¹ æ•´ä½“çš„â€œå®è¯â€å€¾å‘ä¸‹ï¼Œåªè¦ä¸šåŠ¡æ–¹æ¥å—è¿™ç§åšæ³•ã€å¹¶ä¸”èƒ½å¤Ÿä¸€å®šç¨‹åº¦æŒ‡å¯¼ä¸šåŠ¡ï¼Œæˆ‘ä»¬å°±å¯ä»¥å°†å…¶è§£è¯»ä¸ºæ¦‚ç‡ã€‚æˆ‘ä»¬å°†é€»è¾‘å›å½’è¾“å‡ºç»“æœçœ‹æˆè¿‘ä¼¼æ¦‚ç‡å€¼ã€‚</p><h2 id="sklearnä¸­çš„é€»è¾‘å›å½’">sklearnä¸­çš„é€»è¾‘å›å½’</h2><ul><li>æ­£åˆ™åŒ–(Regularization)</li></ul><p><img src="https://s2.loli.net/2022/06/26/oq5lQmuFOhEkDZP.png"></p><p>ä¸Šè¿°ä¸ºsklearnå®˜æ–¹è§£é‡Šå¯ä»¥çœ‹å‡ºsklearnä¸­æ˜¯é»˜è®¤è¿›è¡Œæ­£åˆ™åŒ–ï¼Œæ¯ä¸ªå¼å­çš„å‰é¢éƒ¨åˆ†ä¸ºç»“æ„é£é™©é¡¹ï¼ˆæ­£åˆ™åŒ–é¡¹ï¼‰,åé¢éƒ¨åˆ†ä¸ºæŸå¤±å‡½æ•°ç»éªŒé£é™©é¡¹ã€‚å½“æˆ‘ä»¬ä¸æƒ³è¿›è¡Œæ­£åˆ™åŒ–çš„æ—¶å€™å¯ä»¥æ§åˆ¶Cå¾ˆå¤§ã€‚</p><table><thead><tr class="header"><th>å‚æ•°</th><th>è§£é‡Š</th></tr></thead><tbody><tr class="odd"><td>penalty</td><td>æ­£åˆ™åŒ–é¡¹</td></tr><tr class="even"><td>dual</td><td>æ˜¯å¦æ±‚è§£å¯¹å¶é—®é¢˜*</td></tr><tr class="odd"><td>tol</td><td>è¿­ä»£åœæ­¢æ¡ä»¶ï¼šä¸¤è½®è¿­ä»£æŸå¤±å€¼å·®å€¼å°äºtolæ—¶ï¼Œåœæ­¢è¿­ä»£</td></tr><tr class="even"><td>C</td><td>ç»éªŒé£é™©å’Œç»“æ„é£é™©åœ¨æŸå¤±å‡½æ•°ä¸­çš„æƒé‡</td></tr><tr class="odd"><td>fit_intercept</td><td>çº¿æ€§æ–¹ç¨‹ä¸­æ˜¯å¦åŒ…å«æˆªè·é¡¹</td></tr><tr class="even"><td>intercept_scaling</td><td>ç›¸å½“äºæ­¤å‰è®¨è®ºçš„ç‰¹å¾æœ€åä¸€åˆ—å…¨ä¸º1çš„åˆ—ï¼Œå½“ä½¿ç”¨liblinearæ±‚è§£å‚æ•°æ—¶ç”¨äºæ•è·æˆªè·</td></tr><tr class="odd"><td>class_weight</td><td>å„ç±»æ ·æœ¬æƒé‡*</td></tr><tr class="even"><td>random_state</td><td>éšæœºæ•°ç§å­</td></tr><tr class="odd"><td>solver</td><td>æŸå¤±å‡½æ•°æ±‚è§£æ–¹æ³•*</td></tr><tr class="even"><td>max_iter</td><td>æ±‚è§£å‚æ•°æ—¶æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼Œè¿­ä»£è¿‡ç¨‹æ»¡è¶³max_iteræˆ–tolå…¶ä¸€å³åœæ­¢è¿­ä»£</td></tr><tr class="odd"><td>multi_class</td><td>å¤šåˆ†ç±»é—®é¢˜æ—¶æ±‚è§£æ–¹æ³•*</td></tr><tr class="even"><td>verbose</td><td>æ˜¯å¦è¾“å‡ºä»»åŠ¡è¿›ç¨‹</td></tr><tr class="odd"><td>warm_start</td><td>æ˜¯å¦ä½¿ç”¨ä¸Šæ¬¡è®­ç»ƒç»“æœä½œä¸ºæœ¬æ¬¡è¿è¡Œåˆå§‹å‚æ•°</td></tr><tr class="even"><td>l1_ratio</td><td>å½“é‡‡ç”¨å¼¹æ€§ç½‘æ­£åˆ™åŒ–æ—¶ï¼Œ<span class="math inline">\(l1\)</span>æ­£åˆ™é¡¹æƒé‡ï¼Œå°±æ˜¯æŸå¤±å‡½æ•°ä¸­çš„<span class="math inline">\(\rho\)</span></td></tr></tbody></table><ul><li>dualï¼šæ˜¯å¦æ±‚è§£å¯¹å¶é—®é¢˜</li></ul><p>â€ƒâ€ƒå¯¹å¶é—®é¢˜æ˜¯çº¦æŸæ¡ä»¶ç›¸åã€æ±‚è§£æ–¹å‘ä¹Ÿç›¸åçš„é—®é¢˜ï¼Œå½“æ•°æ®é›†è¿‡å°è€Œç‰¹å¾è¾ƒå¤šæ—¶ï¼Œæ±‚è§£å¯¹å¶é—®é¢˜èƒ½ä¸€å®šç¨‹åº¦é™ä½è¿ç®—å¤æ‚åº¦ï¼Œå…¶ä»–æƒ…å†µå»ºè®®ä¿ç•™é»˜è®¤å‚æ•°å–å€¼ã€‚</p><ul><li>class_weight:å„ç±»æ ·æœ¬æƒé‡</li></ul><p>â€ƒâ€ƒclass_weightå…¶å®ä»£è¡¨å„ç±»æ ·æœ¬åœ¨è¿›è¡ŒæŸå¤±å‡½æ•°è®¡ç®—æ—¶çš„æ•°å€¼æƒé‡ï¼Œä¾‹å¦‚å‡è®¾ä¸€ä¸ªäºŒåˆ†ç±»é—®é¢˜ï¼Œ0ã€1ä¸¤ç±»çš„æ ·æœ¬æ¯”ä¾‹æ˜¯2:1ï¼Œæ­¤æ—¶å¯ä»¥è¾“å…¥ä¸€ä¸ªå­—å…¸ç±»å‹å¯¹è±¡ç”¨äºè¯´æ˜ä¸¤ç±»æ ·æœ¬åœ¨è¿›è¡ŒæŸå¤±å€¼è®¡ç®—æ—¶çš„æƒé‡ï¼Œä¾‹å¦‚è¾“å…¥:{0:1,1:3}ï¼Œåˆ™ä»£è¡¨1ç±»æ ·æœ¬çš„æ¯ä¸€æ¡æ•°æ®åœ¨è¿›è¡ŒæŸå¤±å‡½æ•°å€¼çš„è®¡ç®—æ—¶éƒ½ä¼šåœ¨åŸå§‹æ•°å€¼ä¸Š*3ã€‚è€Œå½“æˆ‘ä»¬å°†è¯¥å‚æ•°é€‰ä¸º<code>balanced</code>æ—¶ï¼Œåˆ™ä¼šè‡ªåŠ¨å°†è¿™ä¸ªæ¯”ä¾‹è°ƒæ•´ä¸ºçœŸå®æ ·æœ¬æ¯”ä¾‹çš„åæ¯”ï¼Œä»¥è¾¾åˆ°å¹³è¡¡çš„æ•ˆæœã€‚</p><ul><li>solverï¼šæŸå¤±å‡½æ•°æ±‚è§£æ–¹æ³•</li></ul><p>â€ƒâ€ƒå…¶å®é™¤äº†æœ€å°äºŒä¹˜æ³•å’Œæ¢¯åº¦ä¸‹é™ä»¥å¤–ï¼Œè¿˜æœ‰éå¸¸å¤šçš„å…³äºæŸå¤±å‡½æ•°çš„æ±‚è§£æ–¹æ³•ï¼Œè€Œé€‰æ‹©æŸå¤±å‡½æ•°çš„å‚æ•°ï¼Œå°±æ˜¯solverå‚æ•°ã€‚</p><p>â€ƒâ€ƒè€Œå½“å‰æŸå¤±å‡½æ•°åˆ°åº•é‡‡ç”¨ä½•ç§ä¼˜åŒ–æ–¹æ³•è¿›è¡Œæ±‚è§£ï¼Œå…¶å®æœ€ç»ˆç›®çš„æ˜¯å¸Œæœ›èƒ½å¤Ÿæ›´å¿«ï¼ˆè®¡ç®—æ•ˆç‡æ›´é«˜ï¼‰æ›´å¥½ï¼ˆå‡†ç¡®æ€§æ›´é«˜ï¼‰çš„æ¥è¿›è¡Œæ±‚è§£ï¼Œè€Œç¡¬æ€§çš„çº¦æŸæ¡ä»¶æ˜¯æŸå¤±å‡½æ•°çš„å½¢æ€ï¼Œæ­¤å¤–åˆ™æ˜¯ç”¨æˆ·è‡ªè¡Œé€‰æ‹©çš„ç©ºé—´ã€‚ä¸‹é¢ä¸ºå®˜æ–¹ç»™å‡ºçš„solveråˆ—è¡¨</p><p><img src="https://s2.loli.net/2022/06/26/gAFjBUWPho7C8nG.png"></p><ul><li>multi_classï¼šé€‰ç”¨ä½•ç§æ–¹æ³•è¿›è¡Œå¤šåˆ†ç±»é—®é¢˜æ±‚è§£</li></ul><p>å¯é€‰OVRå’ŒMVMï¼Œå½“ç„¶é»˜è®¤æƒ…å†µæ˜¯autoï¼Œæ­¤æ—¶æ¨¡å‹ä¼šä¼˜å…ˆæ ¹æ®æƒ©ç½šé¡¹å’Œsolveré€‰æ‹©OVRè¿˜æ˜¯MVMï¼Œä½†ä¸€èˆ¬æ¥è¯´ï¼ŒMVMæ•ˆæœä¼šå¥½äºOVRã€‚</p><h2 id="åˆ©ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡è¿›è¡Œå‚æ•°ä¼°è®¡">åˆ©ç”¨æå¤§ä¼¼ç„¶ä¼°è®¡è¿›è¡Œå‚æ•°ä¼°è®¡</h2><p>é€»è¾‘å›å½’æ¨¡å‹å¦‚ä¸‹ï¼š <span class="math display">\[y = \frac{1}{1+\exp(-\hat{w}^{T}\cdot\hat{x})}\quad\hat{w}^{T}=(w_1,w_2,\dots,w_n,b)^{T}\,,\hat{x}=(x_1,x_2,\dots,x_n,1)^{T}\\\]</span> å›ºå®šä¸€ç»„<span class="math inline">\(\hat{w}^{T}\)</span>å’Œ<span class="math inline">\(\hat{x}\)</span>å¾—:</p><p><span class="math display">\[p(y=1\vert\hat{w}^{T},\hat{x}) =\frac{1}{1+\exp(-\hat{w}^{T}\cdot\hat{x})} \quadp(y=1\vert\hat{w}^{T},\hat{x}) =\frac{1}{1+\exp(-\hat{w}^{T}\cdot\hat{x})}\\\]</span></p><p>ä»¤<span class="math inline">\(p_1(\hat{w}^{T},\hat{x})=p(y=1\vert\hat{w}^{T},\hat{x}),p_0(\hat{w}^{T},\hat{x})=p(y=0\vert\hat{w}^{T},\hat{x})\)</span></p><p>å¾—ï¼š<span class="math inline">\(p(y=y_i)=p_1^{y_i}(\hat{w}^{T},\hat{x})\cdotp_0^{1-y_i}(\hat{w}^{T},\hat{x})\)</span></p><p>åˆ™ä¼¼ç„¶å‡½æ•°ä¸º<span class="math inline">\(L(y_i;\hat{w}^{T},\hat{x})=\prod_{i=1}^{n}p(y=y_i)=\prod_{i=1}^{n}p_1^{y_i}(\hat{w}^{T},\hat{x})\cdotp_0^{1-y_i}(\hat{w}^{T},\hat{x})\)</span></p><p>è¿›è€Œ<span class="math inline">\(\ln L=\sum_{i=1}^{n}(\lnp_1^{y_i}(\hat{w}^{T},\hat{x})+\lnp_0^{1-y_i}(\hat{w}^{T},\hat{x}))=\sum_{i=1}^{n}(y_i\lnp_1(\hat{w}^{T},\hat{x})+(1-y_i)\lnp_0(\hat{w}^{T},\hat{x}))\)</span></p><p>é€šè¿‡ä¸€ç³»åˆ—æ•°å­¦è¿‡ç¨‹å¯ä»¥è¯æ˜ï¼Œé€šè¿‡æå¤§ä¼¼ç„¶ä¼°è®¡æ„å»ºçš„æŸå¤±å‡½æ•°æ˜¯å‡¸å‡½æ•°ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥é‡‡ç”¨å¯¼æ•°ä¸º0è”ç«‹æ–¹ç¨‹ç»„çš„æ–¹å¼è¿›è¡Œæ±‚è§£ï¼Œè¿™ä¹Ÿæ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡å¯¹å‚æ•°æ±‚è§£çš„ä¸€èˆ¬æ–¹æ³•ã€‚ä½†è¿™ç§æ–¹æ³•ä¼šæ¶‰åŠå¤§é‡çš„å¯¼æ•°è¿ç®—ã€æ–¹ç¨‹ç»„æ±‚è§£ç­‰ï¼Œå¹¶ä¸é€‚ç”¨äºå¤§è§„æ¨¡ç”šè‡³æ˜¯è¶…å¤§è§„æ¨¡æ•°å€¼è¿ç®—ï¼Œå› æ­¤ï¼Œåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œæˆ‘ä»¬é€šå¸¸ä¼šé‡‡ç”¨ä¸€äº›æ›´åŠ é€šç”¨çš„ä¼˜åŒ–æ–¹æ³•å¯¹é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°è¿›è¡Œæ±‚è§£ï¼Œé€šå¸¸æ¥è¯´æ˜¯ç‰›é¡¿æ³•æˆ–è€…æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œå…¶ä¸­ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•æ˜¯æœºå™¨å­¦ä¹ ä¸­æœ€ä¸ºé€šç”¨çš„æ±‚è§£æŸå¤±å‡½æ•°çš„ä¼˜åŒ–ç®—æ³•.</p><p>ä¸ºäº†æ–¹ä¾¿æ±‚æœ€å°å€¼å°†å…¶è½¬åŒ–ä¸º: <span class="math display">\[\ln L=-\sum_{i=1}^{n}(y_i\ln p_1(\hat{w}^{T},\hat{x})+(1-y_i)\lnp_0(\hat{w}^{T},\hat{x}))\]</span></p><h2 id="ç†µç›¸å¯¹ç†µä¸äº¤å‰ç†µ">ç†µã€ç›¸å¯¹ç†µä¸äº¤å‰ç†µ</h2><p>###ç†µ</p><p>é€šå¸¸æˆ‘ä»¬ç”¨ç†µï¼ˆentropyï¼‰æ¥è¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œæˆ–è€…è¯´ç³»ç»Ÿæ··ä¹±ç¨‹åº¦ã€ä¿¡æ¯æ··ä¹±ç¨‹åº¦ã€‚ç†µçš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š<span class="math display">\[entrop(X) = -\sum_{i=1}^{n}p(x_i)log(x_i)\]</span>å¯ä»¥è¯æ˜ï¼Œç†µçš„è®¡ç®—ç»“æœåœ¨[0,1]ä¹‹é—´ï¼Œå¹¶ä¸”ç†µå€¼è¶Šå¤§ï¼Œç³»ç»Ÿè¶Šæ··ä¹±ã€ä¿¡æ¯è¶Šæ··ä¹±ã€‚</p><h3 id="ç›¸å¯¹ç†µå’Œäº¤å‰ç†µ">ç›¸å¯¹ç†µå’Œäº¤å‰ç†µ</h3><p>ç›¸å¯¹ç†µä¹Ÿè¢«ç§°ä¸ºKullback-Leibleræ•£åº¦ï¼ˆKLæ•£åº¦ï¼‰æˆ–è€…ä¿¡æ¯æ•£åº¦ï¼ˆinformationdivergenceï¼‰ã€‚é€šå¸¸ç”¨æ¥è¡¡é‡ä¸¤ä¸ªéšæœºå˜é‡åˆ†å¸ƒçš„å·®å¼‚æ€§ã€‚å‡è®¾å¯¹åŒä¸€ä¸ªéšæœºå˜é‡Xï¼Œæœ‰ä¸¤ä¸ªå•ç‹¬çš„æ¦‚ç‡åˆ†å¸ƒP(x)å’ŒQ(x)ï¼Œå½“Xæ˜¯ç¦»æ•£å˜é‡æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¦‚ä¸‹ç›¸å¯¹ç†µè®¡ç®—å…¬å¼æ¥è¡¡é‡äºŒè€…å·®å¼‚ï¼š<span class="math display">\[D_{KL}(P\vert\vert Q) = \sum_{i=1}^{n}P(x_i)log(\frac{P(x_i)}{Q(x_i)})\]</span> å’Œä¿¡æ¯ç†µç±»ä¼¼ï¼Œç›¸å¯¹ç†µè¶Šå°ï¼Œä»£è¡¨Q(x)å’ŒP(x)è¶Šæ¥è¿‘ã€‚</p><p>ä»äº¤å‰ç†µçš„è®¡ç®—å…¬å¼ä¸éš¾çœ‹å‡ºï¼Œè¿™å…¶å®æ˜¯ä¸€ç§éå¯¹ç§°æ€§åº¦é‡ï¼Œä¹Ÿå°±æ˜¯<span class="math inline">\(D_{KL}(P\vert\vert Q)\ne D_{KL}(Q\vert\vertP)\)</span>ã€‚ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œç›¸å¯¹ç†µåˆ»ç”»çš„æ˜¯ç”¨æ¦‚ç‡åˆ†å¸ƒQæ¥åˆ»ç”»æ¦‚ç‡åˆ†å¸ƒPçš„å›°éš¾ç¨‹åº¦ï¼Œè€Œåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼Œæˆ‘ä»¬ä¸€èˆ¬ä»¤Qä¸ºæ¨¡å‹è¾“å‡ºç»“æœï¼Œè€ŒPä¸ºæ•°æ®é›†æ ‡ç­¾çœŸå®ç»“æœï¼Œä»¥æ­¤æ¥åˆ¤æ–­æ¨¡å‹è¾“å‡ºç»“æœæ˜¯å¦è¶³å¤Ÿæ¥è¿‘çœŸå®æƒ…å†µã€‚</p><ul><li>Qä¸ºæ‹Ÿåˆåˆ†å¸ƒPä¸ºçœŸå®åˆ†å¸ƒï¼Œä¹Ÿè¢«ç§°ä¸ºå‰å‘KLæ•£åº¦ï¼ˆforward KLdivergenceï¼‰ã€‚</li></ul><p><span class="math display">\[\begin{split}D_{KL}(P\vert\vert Q) &amp;=\sum_{i=1}^{n}P(x_i)log(\frac{P(x_i)}{Q(x_i)})\\&amp;=\sum_{i=1}^{n}P(x_i)log(P(x_i))-\sum_{i=1}^{n}P(x_i)log(Q(x_i))\\&amp;=-entropy(P(X))+cross\_entropy(P,Q)\end{split}\]</span></p><p>å¯¹äºç»™å®šæ•°æ®é›†ï¼Œå…¶ä¿¡æ¯ç†µæ˜¯ç¡®å®šçš„ã€‚å› æ­¤ï¼Œå¦‚æœæˆ‘ä»¬å¸Œæœ›Pã€QäºŒè€…åˆ†å¸ƒå°½å¯èƒ½æ¥è¿‘ï¼Œæˆ‘ä»¬å°±éœ€è¦å°½å¯èƒ½å‡å°‘ç›¸å¯¹ç†µï¼Œä½†ç”±äºç›¸å¯¹ç†µ=äº¤å‰ç†µ-ä¿¡æ¯ç†µï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½åŠ›æ±‚å‡å°‘äº¤å‰ç†µã€‚å½“ç„¶ï¼Œä¹Ÿæ­£å› å¦‚æ­¤ï¼Œäº¤å‰ç†µå¯ä»¥ä½œä¸ºè¡¡é‡æ¨¡å‹è¾“å‡ºåˆ†å¸ƒæ˜¯å¦æ¥è¿‘çœŸå®åˆ†å¸ƒçš„é‡è¦åº¦é‡æ–¹æ³•ã€‚</p><p>ç®€å•æ€»ç»“ä¸Šè¿°è¿‡ç¨‹è¦ç‚¹ï¼š</p><ul><li>æˆ‘ä»¬ç”¨ç›¸å¯¹ç†µ<span class="math inline">\(ğ·_{ğ¾ğ¿}(ğ‘ƒ||ğ‘„)\,D_{KL}(P||Q)\)</span>æ¥è¡¨ç¤ºæ¨¡å‹æ‹Ÿåˆåˆ†å¸ƒQå’Œæ•°æ®çœŸå®åˆ†å¸ƒPä¹‹é—´çš„å·®è·ï¼Œç›¸å¯¹ç†µè¶Šå°æ‹Ÿåˆæ•ˆæœè¶Šå¥½ï¼›</li><li>æ ¹æ®è®¡ç®—å…¬å¼(6),ç›¸å¯¹ç†µ=äº¤å‰ç†µ-ä¿¡æ¯ç†µï¼›</li><li>å¯¹äºç»™å®šæ•°æ®é›†ï¼Œä¿¡æ¯ç†µæ˜¯ç¡®å®šçš„ï¼Œå› æ­¤æˆ‘ä»¬åªèƒ½é€šè¿‡å°½å¯èƒ½å‡å°äº¤å‰ç†µæ¥é™ä½ç›¸å¯¹ç†µï¼›</li></ul><p>æ ¹æ®å‰å¸ƒæ–¯ä¸ç­‰å¼ï¼Œç›¸å¯¹ç†µçš„å–å€¼æ’å¤§äºç­‰äºé›¶ï¼Œå½“é¢„æµ‹åˆ†å¸ƒå’ŒçœŸå®åˆ†å¸ƒå®Œå…¨ä¸€è‡´æ—¶ç›¸å¯¹ç†µå–å€¼ä¸º0ï¼Œæ­¤æ—¶äº¤å‰ç†µç­‰äºæ•°æ®ä¿¡æ¯ç†µï¼Œæ­¤å¤–åªè¦äºŒè€…åˆ†å¸ƒä¸ä¸€è‡´ï¼Œäº¤å‰ç†µçš„å–å€¼éƒ½å°†å¤§äºä¿¡æ¯ç†µã€‚</p><h3 id="äºŒåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°">äºŒåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°</h3><p><span class="math display">\[binaryCE(\hat{w}) =-\sum_{i=1}^{n}(y_ilog(p_1(\hat{w}^{T},\hat{x}))+(1-y_i)log(p_0(\hat{w}^{T},\hat{x})))\]</span></p><h2 id="é€»è¾‘å›å½’åº”ç”¨">é€»è¾‘å›å½’åº”ç”¨</h2><p>è¯¥æ•°æ®é›†ä¸ºTelco Customer Churn ç”µä¿¡ç”¨æˆ·æµå¤±é¢„æµ‹æ¡ˆä¾‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">import</span> seaborn <span class="hljs-keyword">as</span> sns<br>sns.set_theme(style=<span class="hljs-string">&quot;darkgrid&quot;</span>)<span class="hljs-comment">#ç”¨æ¥è®¾ç½®ä¸»é¢˜èƒŒæ™¯</span><br>plt.rcParams[<span class="hljs-string">&quot;font.sans-serif&quot;</span>] = [<span class="hljs-string">&quot;SimHei&quot;</span>] <span class="hljs-comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºä¸­æ–‡æ ‡ç­¾</span><br>plt.rcParams[<span class="hljs-string">&quot;axes.unicode_minus&quot;</span>] = <span class="hljs-literal">False</span> <span class="hljs-comment">#ç”¨æ¥æ­£å¸¸æ˜¾ç¤ºè´Ÿå·</span><br><span class="hljs-comment"># Read data</span><br>tcc = pd.read_csv(<span class="hljs-string">&#x27;WA_Fn-UseC_-Telco-Customer-Churn.csv&#x27;</span>)<br><span class="hljs-comment"># æ ‡æ³¨è¿ç»­/ç¦»æ•£å­—æ®µ</span><br><span class="hljs-comment"># ç¦»æ•£å­—æ®µ</span><br>category_cols = [<span class="hljs-string">&#x27;gender&#x27;</span>, <span class="hljs-string">&#x27;SeniorCitizen&#x27;</span>, <span class="hljs-string">&#x27;Partner&#x27;</span>, <span class="hljs-string">&#x27;Dependents&#x27;</span>,<br>               <span class="hljs-string">&#x27;PhoneService&#x27;</span>, <span class="hljs-string">&#x27;MultipleLines&#x27;</span>, <span class="hljs-string">&#x27;InternetService&#x27;</span>, <span class="hljs-string">&#x27;OnlineSecurity&#x27;</span>, <span class="hljs-string">&#x27;OnlineBackup&#x27;</span>, <br>                <span class="hljs-string">&#x27;DeviceProtection&#x27;</span>, <span class="hljs-string">&#x27;TechSupport&#x27;</span>, <span class="hljs-string">&#x27;StreamingTV&#x27;</span>, <span class="hljs-string">&#x27;StreamingMovies&#x27;</span>, <span class="hljs-string">&#x27;Contract&#x27;</span>, <span class="hljs-string">&#x27;PaperlessBilling&#x27;</span>,<br>                <span class="hljs-string">&#x27;PaymentMethod&#x27;</span>]<br><br><span class="hljs-comment"># è¿ç»­å­—æ®µ</span><br>numeric_cols = [<span class="hljs-string">&#x27;tenure&#x27;</span>, <span class="hljs-string">&#x27;MonthlyCharges&#x27;</span>, <span class="hljs-string">&#x27;TotalCharges&#x27;</span>]<br><br><span class="hljs-comment"># æ ‡ç­¾</span><br>target = <span class="hljs-string">&#x27;Churn&#x27;</span><br><br><span class="hljs-comment"># IDåˆ—</span><br>ID_col = <span class="hljs-string">&#x27;customerID&#x27;</span><br><br><span class="hljs-comment"># éªŒè¯æ˜¯å¦åˆ’åˆ†èƒ½å®Œå…¨</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(category_cols) + <span class="hljs-built_in">len</span>(numeric_cols) + <span class="hljs-number">2</span> == tcc.shape[<span class="hljs-number">1</span>]<br><span class="hljs-comment">#Verify whether the ID column is duplicate</span><br>tcc[ID_col].nunique() == tcc.shape[<span class="hljs-number">0</span>]<br><span class="hljs-comment">#Verify whether have the explict missing values</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">missing</span>(<span class="hljs-params">df</span>):<br>    <span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">    Caculate the proportion of the missing value</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br>    missing_number = df.isnull().<span class="hljs-built_in">sum</span>().sort_values(ascending=<span class="hljs-literal">False</span>) <span class="hljs-comment">#decending</span><br>    missing_per = (df.isnull().<span class="hljs-built_in">sum</span>()/df.count()).sort_values(ascending=<span class="hljs-literal">False</span>) <span class="hljs-comment">#decending</span><br>    missing_df = pd.concat([missing_number,missing_per],axis=<span class="hljs-number">1</span>,keys=[<span class="hljs-string">&quot;Missing_number&quot;</span>,<span class="hljs-string">&quot;Missing_per&quot;</span>])<br>    <span class="hljs-keyword">return</span> missing_df<br><span class="hljs-comment">#Verify whether have the discrete explict missing values</span><br><span class="hljs-keyword">for</span> feature <span class="hljs-keyword">in</span> category_cols:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;:&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(feature,tcc[feature].unique()))<br> <span class="hljs-comment">#Verify whether have the continuous explict missing values</span><br>tcc[numeric_cols].astype(<span class="hljs-built_in">float</span>)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">find_index</span>(<span class="hljs-params">data_col,value</span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    Verify the first occurance of the given value in the given column,return -1 if there is none.</span><br><span class="hljs-string">    param data_col:given column</span><br><span class="hljs-string">    param value:given value</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    val_lst = [value]<br>    <span class="hljs-keyword">if</span> data_col.isin(val_lst).<span class="hljs-built_in">sum</span>() == <span class="hljs-number">0</span>:<br>        <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        res = data_col.isin(val_lst).idxmax()<br>    <span class="hljs-keyword">return</span> res<br><span class="hljs-keyword">for</span> feature <span class="hljs-keyword">in</span> numeric_cols:<br>    <span class="hljs-built_in">print</span>(find_index(tcc[feature],<span class="hljs-string">&quot; &quot;</span>))<br>tcc[<span class="hljs-string">&quot;TotalCharges&quot;</span>] = tcc[<span class="hljs-string">&quot;TotalCharges&quot;</span>].apply(<span class="hljs-keyword">lambda</span> x:x <span class="hljs-keyword">if</span> x!=<span class="hljs-string">&quot; &quot;</span><span class="hljs-keyword">else</span> np.nan).astype(<span class="hljs-built_in">float</span>)<br>tcc[<span class="hljs-string">&quot;MonthlyCharges&quot;</span>] = tcc[<span class="hljs-string">&quot;MonthlyCharges&quot;</span>].astype(<span class="hljs-built_in">float</span>)<br>tcc[<span class="hljs-string">&quot;TotalCharges&quot;</span>]=tcc[<span class="hljs-string">&quot;TotalCharges&quot;</span>].fillna(<span class="hljs-number">0</span>)<br><span class="hljs-comment">#Outlier detection</span><br>plt.figure(figsize=(<span class="hljs-number">16</span>, <span class="hljs-number">6</span>), dpi=<span class="hljs-number">200</span>)<br>plt.subplot(<span class="hljs-number">121</span>)<br>plt.boxplot(tcc[<span class="hljs-string">&#x27;MonthlyCharges&#x27;</span>])<br>plt.xlabel(<span class="hljs-string">&#x27;MonthlyCharges&#x27;</span>)<br>plt.subplot(<span class="hljs-number">122</span>)<br>plt.boxplot(tcc[<span class="hljs-string">&#x27;TotalCharges&#x27;</span>])<br>plt.xlabel(<span class="hljs-string">&#x27;TotalCharges&#x27;</span>)<br>tcc[target].replace(to_replace=<span class="hljs-string">&quot;Yes&quot;</span>,value=<span class="hljs-number">1</span>,inplace=<span class="hljs-literal">True</span>)<br>tcc[target].replace(to_replace=<span class="hljs-string">&quot;No&quot;</span>,value=<span class="hljs-number">0</span>,inplace=<span class="hljs-literal">True</span>)<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> train_test_split<br>train,test = train_test_split(tcc,random_state=<span class="hljs-number">666</span>,test_size=<span class="hljs-number">0.3</span>)<br>X_train = train.drop(columns=[ID_col,target]).copy()<br>y_train = train[target].copy()<br>X_test = test.drop(columns=[ID_col,target]).copy()<br>y_test = test[target].copy()<br><span class="hljs-keyword">from</span> sklearn.preprocessing <span class="hljs-keyword">import</span> OneHotEncoder,KBinsDiscretizer,StandardScaler<br><span class="hljs-keyword">from</span> sklearn.compose <span class="hljs-keyword">import</span> ColumnTransformer<br><span class="hljs-keyword">from</span> sklearn.pipeline <span class="hljs-keyword">import</span> make_pipeline<br><span class="hljs-keyword">from</span> sklearn.linear_model <span class="hljs-keyword">import</span> LogisticRegression<br><span class="hljs-keyword">from</span> sklearn.model_selection <span class="hljs-keyword">import</span> GridSearchCV<br>logistic_pre = ColumnTransformer([(<span class="hljs-string">&quot;cat&quot;</span>,OneHotEncoder(drop=<span class="hljs-string">&quot;if_binary&quot;</span>),category_cols),(<span class="hljs-string">&quot;num&quot;</span>,<span class="hljs-string">&quot;passthrough&quot;</span>,numeric_cols)])<br>logistic_model = LogisticRegression(max_iter=<span class="hljs-built_in">int</span>(<span class="hljs-number">1e8</span>))<br>logistic_pipe = make_pipeline(logistic_pre,logistic_model)<br>num_sel = [<span class="hljs-string">&quot;passthrough&quot;</span>,StandardScaler(),KBinsDiscretizer(n_bins=<span class="hljs-number">3</span>,encode=<span class="hljs-string">&quot;ordinal&quot;</span>,strategy=<span class="hljs-string">&quot;kmeans&quot;</span>)]<br>logistic_param = [&#123;<span class="hljs-string">&quot;columntransformer__num&quot;</span>:num_sel<br>                   ,<span class="hljs-string">&quot;logisticregression__penalty&quot;</span>:[<span class="hljs-string">&quot;l1&quot;</span>]<br>                   ,<span class="hljs-string">&quot;logisticregression__C&quot;</span>:np.arange(<span class="hljs-number">0.1</span>,<span class="hljs-number">2.1</span>,<span class="hljs-number">0.1</span>).tolist()<br>                   ,<span class="hljs-string">&quot;logisticregression__solver&quot;</span>:[<span class="hljs-string">&quot;saga&quot;</span>]&#125;<br>                 ,&#123;<span class="hljs-string">&quot;columntransformer__num&quot;</span>:num_sel<br>                   ,<span class="hljs-string">&quot;logisticregression__penalty&quot;</span>:[<span class="hljs-string">&quot;l2&quot;</span>]<br>                   ,<span class="hljs-string">&quot;logisticregression__C&quot;</span>:np.arange(<span class="hljs-number">0.1</span>,<span class="hljs-number">2.1</span>,<span class="hljs-number">0.1</span>).tolist()<br>                   ,<span class="hljs-string">&quot;logisticregression__solver&quot;</span>:[<span class="hljs-string">&#x27;lbfgs&#x27;</span>, <span class="hljs-string">&#x27;newton-cg&#x27;</span>, <span class="hljs-string">&#x27;sag&#x27;</span>, <span class="hljs-string">&#x27;saga&#x27;</span>]&#125;]<br>logistic_search = GridSearchCV(estimator=logistic_pipe,param_grid=logistic_param,n_jobs=-<span class="hljs-number">1</span>)<br><span class="hljs-keyword">import</span> time<br>s = time.time()<br>logistic_search.fit(X_train,y_train)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(time.time()-s))<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">logit_threshold</span>(BaseEstimator, TransformerMixin):<br>    <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, penalty=<span class="hljs-string">&#x27;l2&#x27;</span>, C=<span class="hljs-number">1.0</span>, max_iter=<span class="hljs-number">1e8</span>, solver=<span class="hljs-string">&#x27;lbfgs&#x27;</span>, l1_ratio=<span class="hljs-literal">None</span>, class_weight=<span class="hljs-literal">None</span>, thr=<span class="hljs-number">0.5</span></span>):<br>        self.penalty = penalty<br>        self.C = C<br>        self.max_iter = max_iter<br>        self.solver = solver<br>        self.l1_ratio = l1_ratio<br>        self.thr = thr<br>        self.class_weight = class_weight<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">fit</span>(<span class="hljs-params">self, X, y</span>):<br>        clf = LogisticRegression(penalty = self.penalty, <br>                                 C = self.C, <br>                                 solver = self.solver, <br>                                 l1_ratio = self.l1_ratio,<br>                                 class_weight=self.class_weight, <br>                                 max_iter=self.max_iter)<br>        clf.fit(X, y)<br>        self.coef_ = clf.coef_<br>        self.clf = clf<br>        <span class="hljs-keyword">return</span> self<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">predict</span>(<span class="hljs-params">self, X</span>):<br>        res = (self.clf.predict_proba(X)[:, <span class="hljs-number">1</span>]&gt;=self.thr) * <span class="hljs-number">1</span><br>        <span class="hljs-keyword">return</span> res<br> <span class="hljs-comment"># è®¾ç½®è½¬åŒ–å™¨æµ</span><br>logistic_pre = ColumnTransformer([<br>    (<span class="hljs-string">&#x27;cat&#x27;</span>, preprocessing.OneHotEncoder(drop=<span class="hljs-string">&#x27;if_binary&#x27;</span>), category_cols), <br>    (<span class="hljs-string">&#x27;num&#x27;</span>, <span class="hljs-string">&#x27;passthrough&#x27;</span>, numeric_cols)<br>])<br><br>num_pre = [<span class="hljs-string">&#x27;passthrough&#x27;</span>, preprocessing.StandardScaler(), preprocessing.KBinsDiscretizer(n_bins=<span class="hljs-number">3</span>, encode=<span class="hljs-string">&#x27;ordinal&#x27;</span>, strategy=<span class="hljs-string">&#x27;kmeans&#x27;</span>)]<br><br><span class="hljs-comment"># å®ä¾‹åŒ–é€»è¾‘å›å½’è¯„ä¼°å™¨</span><br>logistic_model = logit_threshold(max_iter=<span class="hljs-built_in">int</span>(<span class="hljs-number">1e8</span>))<br><br><span class="hljs-comment"># è®¾ç½®æœºå™¨å­¦ä¹ æµ</span><br>logistic_pipe = make_pipeline(logistic_pre, logistic_model)<br><br><span class="hljs-comment"># è®¾ç½®è¶…å‚æ•°ç©ºé—´</span><br>logistic_param = [<br>    &#123;<span class="hljs-string">&#x27;columntransformer__num&#x27;</span>:num_pre, <span class="hljs-string">&#x27;logit_threshold__thr&#x27;</span>: np.arange(<span class="hljs-number">0.1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>).tolist(), <span class="hljs-string">&#x27;logit_threshold__penalty&#x27;</span>: [<span class="hljs-string">&#x27;l1&#x27;</span>], <span class="hljs-string">&#x27;logit_threshold__C&#x27;</span>: np.arange(<span class="hljs-number">0.1</span>, <span class="hljs-number">1.1</span>, <span class="hljs-number">0.1</span>).tolist(), <span class="hljs-string">&#x27;logit_threshold__solver&#x27;</span>: [<span class="hljs-string">&#x27;saga&#x27;</span>]&#125;, <br>    &#123;<span class="hljs-string">&#x27;columntransformer__num&#x27;</span>:num_pre, <span class="hljs-string">&#x27;logit_threshold__thr&#x27;</span>: np.arange(<span class="hljs-number">0.1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">0.1</span>).tolist(), <span class="hljs-string">&#x27;logit_threshold__penalty&#x27;</span>: [<span class="hljs-string">&#x27;l2&#x27;</span>], <span class="hljs-string">&#x27;logit_threshold__C&#x27;</span>: np.arange(<span class="hljs-number">0.1</span>, <span class="hljs-number">1.1</span>, <span class="hljs-number">0.1</span>).tolist(), <span class="hljs-string">&#x27;logit_threshold__solver&#x27;</span>: [<span class="hljs-string">&#x27;lbfgs&#x27;</span>, <span class="hljs-string">&#x27;newton-cg&#x27;</span>, <span class="hljs-string">&#x27;sag&#x27;</span>, <span class="hljs-string">&#x27;saga&#x27;</span>]&#125;, <br>]<br><br><span class="hljs-comment"># å®ä¾‹åŒ–ç½‘æ ¼æœç´¢è¯„ä¼°å™¨</span><br>logistic_search_f1 = GridSearchCV(estimator = logistic_pipe,<br>                                  param_grid = logistic_param,<br>                                  scoring=<span class="hljs-string">&#x27;f1&#x27;</span>,<br>                                  n_jobs = <span class="hljs-number">12</span>)<br><br>s = time.time()<br>logistic_search_f1.fit(X_train, y_train)<br><span class="hljs-built_in">print</span>(time.time()-s, <span class="hljs-string">&quot;s&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="é€»è¾‘å›å½’æ¨¡å‹è§£é‡Š">é€»è¾‘å›å½’æ¨¡å‹è§£é‡Š</h2><p>å¯¹äºé€»è¾‘å›å½’çš„æ¨¡å‹è§£é‡Šï¼Œæ ¸å¿ƒæ˜¯éœ€è¦è§‚å¯Ÿçº¿æ€§æ–¹ç¨‹ä¸­è‡ªå˜é‡çš„ç³»æ•°ï¼Œé€šè¿‡ç³»æ•°å¤§å°å¯ä»¥åˆ¤æ–­ç‰¹å¾é‡è¦æ€§ï¼Œå¹¶ä¸”ç³»æ•°çš„å…·ä½“æ•°å€¼ä¹Ÿèƒ½è¡¨ç¤ºå› å˜é‡å¦‚ä½•ä¼´éšè‡ªå˜é‡å˜åŒ–è€Œå˜åŒ–ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#æŸ¥çœ‹é€»è¾‘å›å½’ç³»æ•°</span><br>coe = logistic_search.best_estimator_.named_steps[<span class="hljs-string">&#x27;logit_threshold&#x27;</span>].coef_<br>coe = coe.flatten()<br>coe<br><span class="hljs-comment"># å®šä½ç‹¬çƒ­ç¼–ç è½¬åŒ–å™¨</span><br>tf = logistic_search.best_estimator_.named_steps[<span class="hljs-string">&#x27;columntransformer&#x27;</span>].named_transformers_[<span class="hljs-string">&#x27;cat&#x27;</span>]<br>tf<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">cate_colName</span>(<span class="hljs-params">Transformer, category_cols, drop=<span class="hljs-string">&#x27;if_binary&#x27;</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">    ç¦»æ•£å­—æ®µç‹¬çƒ­ç¼–ç åå­—æ®µååˆ›å»ºå‡½æ•°</span><br><span class="hljs-string">    </span><br><span class="hljs-string">    :param Transformer: ç‹¬çƒ­ç¼–ç è½¬åŒ–å™¨</span><br><span class="hljs-string">    :param category_cols: è¾“å…¥è½¬åŒ–å™¨çš„ç¦»æ•£å˜é‡</span><br><span class="hljs-string">    :param drop: ç‹¬çƒ­ç¼–ç è½¬åŒ–å™¨çš„dropå‚æ•°</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    <br>    cate_cols_new = []<br>    col_value = Transformer.categories_<br>    <br>    <span class="hljs-keyword">for</span> i, j <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(category_cols):<br>        <span class="hljs-keyword">if</span> (drop == <span class="hljs-string">&#x27;if_binary&#x27;</span>) &amp; (<span class="hljs-built_in">len</span>(col_value[i]) == <span class="hljs-number">2</span>):<br>            cate_cols_new.append(j)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">for</span> f <span class="hljs-keyword">in</span> col_value[i]:<br>                feature_name = j + <span class="hljs-string">&#x27;_&#x27;</span> + f<br>                cate_cols_new.append(feature_name)<br>    <span class="hljs-keyword">return</span>(cate_cols_new)<br><span class="hljs-comment"># è½¬åŒ–åç¦»æ•£å˜é‡åˆ—åç§°</span><br>category_cols_new = cate_colName(tf, category_cols)<br><br><span class="hljs-comment"># æ‰€æœ‰å­—æ®µåç§°</span><br>cols_new = category_cols_new + numeric_cols<br><br><span class="hljs-comment"># æŸ¥çœ‹ç‰¹å¾åç§°æ•°é‡å’Œç‰¹å¾ç³»æ•°æ•°é‡æ˜¯å¦ä¸€è‡´</span><br><span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(cols_new) == <span class="hljs-built_in">len</span>(coe)<br></code></pre></td></tr></table></figure><p>å¯¹äº<span class="math inline">\(\ln\frac{y}{1-y}=\hat{w}^{T}\cdot\hat{x}=w_1x_1+w_2x_2+\dots+w_nx_n+b\)</span>è€Œè¨€æ¯ä¸ª<span class="math inline">\(x_i\)</span>çš„å˜åŒ–ä¼šä¸åŒç¨‹åº¦çš„å½±å“å¯¹æ•°å‡ ç‡çš„å˜åŒ–ã€‚</p><p>ä»¥<span class="math inline">\(\ln\frac{y}{1-y}=2x_1-x_2\)</span>ä¸ºä¾‹<span class="math inline">\(x_1\)</span>æ¯å¢é•¿1,<span class="math inline">\(y\)</span>åˆ¤åˆ«ä¸ºæ­£ä¾‹çš„å¯¹æ•°å‡ ç‡å°±å¢åŠ 2ï¼Œæ¦‚ç‡å°±å¢åŠ 0.4</p><p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥æ ¹æ®ç³»æ•°æ¥åˆ¤åˆ«ç‰¹å¾é‡è¦æ€§ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>machine learning</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
